# Как это работает
## Используемые технологии

#### QEMU
**Э**то бесплатный инструмент с открытым исходным кодом для эмуляции и виртуализации работы операционных систем на компьютере. Программа может работать в Windows, Linux, MacOS и даже на Android. Ресурсы хоста, такие как процессор, жесткий диск, память, разделяются между виртуальными машинами. Qemu использует аппаратную виртуализацию, поэтому может выполнять гостевые операционные системы почти так же быстро, как и на основном железе. Может использоваться гипервизор XEN или модуль ядра KVM в Linux.

#### KVM
**Г**ипервизор KVM представляет из себя загружаемый модуль ядра Linux, который предназначен для обеспечения виртуализации на платформе Linux x86. Сам модуль содержит компонент собственно виртуализации(kvm.ko), и процессорно-специфический загружаемый модуль kvm-amd.ko либо kvm-intel.ko.

Необходимым условием для использования KVM является поддержка инструкций виртуализации — Intel VT либо AMD , и ядро Linux версии 2.6.20 и выше. Существует также порт KVM под Free-BSD. Для вызова KVM традиционно используется QEMU, но также ведутся попытки добавить поддержку KVM в Virtualbox. 

Сам по себе KVM не выполняет эмуляции. Вместо этого программа, работающая в пространстве пользователя, использует интерфейс /dev/kvm для настройки адресного пространства гостя виртуальной машины, через него же эмулирует устройства ввода-вывода и видеоадаптер. KVM позволяет виртуальным машинам использовать немодифицированные образы дисков QEMU, VMware и других, содержащие операционные системы. Каждая виртуальная машина имеет своё собственное виртуальное аппаратное обеспечение: сетевые карты, диск, видеокарту и другие устройства.

#### Libvirt
**C**вободная реализация API, демон и набор инструментов для управления виртуализацией. Позволяет управлять гипервизорами Xen, KVM, VirtualBox, OpenVZ, LXC, User-mode Linux, VMware ESX/GSX/Workstation/Player, QEMU, Hyper-V, PowerVM, Parallels Workstation, bhyve и рядом других средств виртуализации, предоставляет возможность контролировать виртуальные машины по сети, расположенные на других компьютерах. Эти API широко используются в слоях гипервизоров при разработке облачных решений. 

## Как это работает
**В**ышеописанные технологии запускаются на гипервизоре в фоновом режиме и ждут сигналов из *Телеграмм-бота*. Пользователи, которые прошли регистрацию и получили статус "Активный" (статус может изменять только Администратор), имеют возможность создать свою виртуальную тестовую машину. После получения IP-адреса машины, можно отправить на нее свой публичный ключ *(~/ssh/id_rsa.pub)*, это даст возможность подключаться к ВМ по протоколу **SSH** (иметь полный доступ в системе). 

## Безопасность
- Нет возможности подключиться к ВМ по паролю пользователя. *Только при наличии на ней публичного ключа RSA*
- Все виртуальные машины изолированны друг от друга
- В базе данных не используется никакая конфиденциальная информация, поэтому не требует шифрования. *Регистрация происходит по ID пользователя Telegram*
- Используются нестандартные порты для подключения различных сервисов
- В *.gitignore* добавлены файлы содержащие приватную информацию
- (v3.1.0) Добавлена технология проверки ЭЦП при обмене ключами телеграмм-бота с пользователем

### Источники
* [Qemu](https://losst.ru/kak-polzovatsya-qemu)
* [KVM](https://losst.ru/kvm)
* [Libvirt](https://ru.wikipedia.org/wiki/Libvirt)
